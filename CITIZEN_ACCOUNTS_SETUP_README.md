# ๐ ุฏููู ุงูุชุซุจูุช ุงูุณุฑูุน - ูุธุงู ุงูุญุณุงุจ ุงูุดุฎุตู ููููุงุทู

## โก ุงูุชุซุจูุช ูู 3 ุฎุทูุงุช

### ุงูุฎุทูุฉ 1: ุชุดุบูู ุณูุฑูุจุช ุงูุชุซุจูุช

ุงูุชุญ ุงููุชุตูุญ ูุงูุชูู ุฅูู:

```
http://localhost:8080/tekrit_municipality/setup_citizen_accounts_system.php
```

### ุงูุฎุทูุฉ 2: ุงูุชุญูู ูู ุงููุฌุงุญ

ูุฌุจ ุฃู ุชุฑู ุฑุณุงูุฉ: **"๐ ุงูุชุซุจูุช ููุชูู ุจูุฌุงุญ!"**

### ุงูุฎุทูุฉ 3: ุฅุนุฏุงุฏ WhatsApp

1. ุงุฐูุจ ุฅูู: `modules/system_settings.php`
2. ุฃุฏุฎู ุฑูู WhatsApp ููุจูุฏูุฉ (ูุซุงู: 96176123456)
3. ุงุญูุธ ุงูุฅุนุฏุงุฏุงุช

---

## โ ูุง ุชู ุฅูุดุงุคู

### ุงูุฌุฏุงูู (6):
- โ `citizens_accounts` - ุญุณุงุจุงุช ุงูููุงุทููู
- โ `magic_links` - ุฑูุงุจุท ุงูุฏุฎูู ุงูุณุญุฑูุฉ
- โ `citizen_messages` - ุฑุณุงุฆู ุงูุจูุฏูุฉ
- โ `whatsapp_log` - ุณุฌู WhatsApp
- โ `notification_preferences` - ุฅุนุฏุงุฏุงุช ุงูุฅุดุนุงุฑุงุช
- โ `citizen_sessions` - ุฌูุณุงุช ุงูููุงุทููู

### Views (3):
- โ `v_citizens_summary` - ููุฎุต ุงูููุงุทููู
- โ `v_citizen_messages_detailed` - ุงูุฑุณุงุฆู ุงูุชูุตูููุฉ
- โ `v_whatsapp_log_detailed` - ุณุฌู WhatsApp ุงูุชูุตููู

### Stored Procedures (3):
- โ `sp_get_or_create_citizen_account` - ุฅูุดุงุก/ุฌูุจ ุญุณุงุจ
- โ `sp_cleanup_expired_links` - ุชูุธูู ุงูุฑูุงุจุท
- โ `sp_get_citizen_stats` - ุฅุญุตุงุฆูุงุช ุงูููุงุทู

### Triggers (2):
- โ `tr_update_login_count` - ุชุญุฏูุซ ุนุฏุงุฏ ุงูุฏุฎูู
- โ `tr_log_citizen_message` - ุชุณุฌูู ุฑุณุงุฆู WhatsApp

### ุงูุฅุนุฏุงุฏุงุช (10):
- โ ุฅุนุฏุงุฏุงุช WhatsApp ูู `website_settings`

---

## ๐ ุงููููุงุช ุงูููุดุฃุฉ

```
tekrit_municipality/
โโโ database/
โ   โโโ citizen_accounts_system.sql          # ุณูุฑูุจุช SQL ุงููุงูู
โโโ setup_citizen_accounts_system.php         # ุตูุญุฉ ุงูุชุซุจูุช
โโโ CITIZEN_ACCOUNTS_DATABASE_DOCUMENTATION.md # ุงูุชูุซูู ุงููุงูู
โโโ CITIZEN_ACCOUNTS_SETUP_README.md          # ูุฐุง ุงูููู
```

---

## ๐ ุงูุชุญูู ูู ุงูุชุซุจูุช

### ุนุจุฑ phpMyAdmin:

1. ุงูุชุญ phpMyAdmin
2. ุงุฎุชุฑ ูุงุนุฏุฉ ุงูุจูุงูุงุช `tekrit_municipality`
3. ุชุญูู ูู ูุฌูุฏ ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ

### ุนุจุฑ SQL:

```sql
-- ุนุฑุถ ุฌููุน ุงูุฌุฏุงูู ุงูุฌุฏูุฏุฉ
SHOW TABLES LIKE 'citizen%';

-- ุงูุชุญูู ูู ุนุฏุฏ ุงูุฃุนูุฏุฉ
SELECT COUNT(*) FROM information_schema.COLUMNS 
WHERE TABLE_SCHEMA = 'tekrit_municipality' 
AND TABLE_NAME = 'citizens_accounts';

-- ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช
SELECT * FROM website_settings 
WHERE setting_key LIKE 'whatsapp%';
```

---

## โ๏ธ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "ููู SQL ุบูุฑ ููุฌูุฏ"

**ุงูุญู:**
```bash
# ุชุฃูุฏ ูู ูุฌูุฏ ุงูููู ูู ุงููุณุงุฑ ุงูุตุญูุญ
ls -la database/citizen_accounts_system.sql
```

### ุงููุดููุฉ: "ุฎุทุฃ ูู ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช"

**ุงูุญู:**
1. ุชุญูู ูู ุฅุนุฏุงุฏุงุช `config/database.php`
2. ุชุฃูุฏ ูู ุชุดุบูู MySQL/MariaDB
3. ุชุญูู ูู ุงุณู ุงููุณุชุฎุฏู ููููุฉ ุงููุฑูุฑ

### ุงููุดููุฉ: "Table already exists"

**ุงูุญู:**
- ูุฐุง ุชุญุฐูุฑ ููุทุ ูููู ุชุฌุงููู
- ุงูุฌุฏุงูู ุงูููุฌูุฏุฉ ูู ุชุชุฃุซุฑ
- ุงูุจูุงูุงุช ุงูููุฌูุฏุฉ ุขููุฉ

---

## ๐ ุงูุชูุซูู ุงููุงูู

ููุชูุซูู ุงูุชูุตูููุ ุฑุงุฌุน:
- [CITIZEN_ACCOUNTS_DATABASE_DOCUMENTATION.md](CITIZEN_ACCOUNTS_DATABASE_DOCUMENTATION.md)

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

ุจุนุฏ ุงูุชุซุจูุช ุงููุงุฌุญ:

1. โ ุฅุนุฏุงุฏ ุฑูู WhatsApp ูู ุฅุนุฏุงุฏุงุช ุงููุธุงู
2. โญ๏ธ ุฅูุดุงุก ููู `includes/whatsapp_helper.php`
3. โญ๏ธ ุฅูุดุงุก ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู `public/my-account-login.php`
4. โญ๏ธ ุฅูุดุงุก ุงูุตูุญุฉ ุงูุดุฎุตูุฉ `public/my-account.php`
5. โญ๏ธ ุชุญุฏูุซ `public/citizen-requests.php` ููุชุณุฌูู ุงูุชููุงุฆู

---

## ๐ก ูุตุงุฆุญ

- ๐ฆ **ุงููุณุฎ ุงูุงุญุชูุงุทู:** ุงุญุชูุธ ุจูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุงูุชุซุจูุช
- ๐ **ุงูุฃูุงู:** ุบููุฑ ูููุงุช ุงููุฑูุฑ ุงูุงูุชุฑุงุถูุฉ
- ๐งน **ุงูุตูุงูุฉ:** ุดุบูู `sp_cleanup_expired_links()` ููููุงู
- ๐ **ุงููุฑุงูุจุฉ:** ุฑุงูุจ ุณุฌู `whatsapp_log` ููุฃุฎุทุงุก

---

## โ ูุงุฆูุฉ ุงูุชุญูู

- [ ] ุชู ุชุดุบูู `setup_citizen_accounts_system.php`
- [ ] ุฌููุน ุงูุฌุฏุงูู ููุฌูุฏุฉ
- [ ] ุงูุฅุนุฏุงุฏุงุช ููุฌูุฏุฉ ูู `website_settings`
- [ ] ุชู ุฅุฏุฎุงู ุฑูู WhatsApp ููุจูุฏูุฉ
- [ ] ุชู ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช

---

**๐ ูุจุฑูู! ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ ุงูุขู!**

**ุงูุฎุทูุฉ ุงูุชุงููุฉ:** ุฅูุดุงุก ูููุงุช PHP ูููุธุงู

---

๐ **ููุฏุนู:** support@tekrit.gov.lb  
๐๏ธ **ุจูุฏูุฉ ุชูุฑูุช - ุนูุงุฑุ ุดูุงู ูุจูุงู** ๐ฑ๐ง

